{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "exploitDeploymentEvent.schema.json",
    "title": "Exploit Deployment Event",
    "description": "Exploit Deployment Event in HIKE Management API",
    "type": "object",

    "required": ["opID", "eventType", "timestamp", "eventData"],

    "properties": {
        "opID": {
            "type": "string"
        },
        
        "eventType": {
            "type": "string",
            "enum": ["EXPLOIT_DEPLOYMENT"]
        },

        "timestamp": {
            "type": "integer",
            "description": "UNIX Epoch Time"
        },
        
        "eventData": {
            "type": "object",
            "additionalProperties": false,

            "required": ["throwingAgent",
                         "target",
                         "exploit",
                         "reason",
                         "confidence",
                         "result"],

            "properties": {
                "throwingAgent": {
                    "type": "string",
                    "format": "uuid",
                    "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
                },
                
                "target": {
                    "type": "string",
                    "format": "uuid",
                    "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
                },

                "exploit": {
                    "type": "string",
                    "format": "uuid",
                    "pattern": "^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$"
                },

                "reason": {
                    "type": "string"
                },

                "confidence": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 100
                },

                "timestamp": {
                    "description": "Time of exploit deployment using host device clock (NOTE: optional)"
                },

                "result": {
                    "type": "object",
                    "required": ["port", "details"],
                    
                    "properties": {
                        "returnCode": {
                            "type": "integer"
                        },
                        
                        "port": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 65535
                        },

                        "details": {
                            "type": "string"
                        }
                    }
                }
            }
        }
    },
    
    "additionalProperties": false
}

